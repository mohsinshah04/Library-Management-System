{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\12622\\\\Desktop\\\\Library Management System db\\\\frontend\\\\src\\\\components\\\\ProtectedRoute.js\";\nimport React from 'react';\nimport { Navigate } from 'react-router-dom';\n\n/**\r\n * ProtectedRoute Component\r\n * \r\n * Protects routes that require authentication.\r\n * If user is not logged in, redirects to login page.\r\n * If user is logged in but wrong role, redirects to appropriate dashboard.\r\n * \r\n * Usage:\r\n * <ProtectedRoute role=\"student\">\r\n *   <StudentDashboard />\r\n * </ProtectedRoute>\r\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ProtectedRoute({\n  children,\n  role = null\n}) {\n  // Check if user is logged in\n  const token = localStorage.getItem('access_token');\n  const userStr = localStorage.getItem('user');\n\n  // If no token, redirect to login\n  if (!token || !userStr) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 12\n    }, this);\n  }\n  try {\n    const user = JSON.parse(userStr);\n\n    // If role is specified, check if user has the correct role\n    if (role && user.role !== role) {\n      // Redirect to appropriate dashboard based on user's role\n      if (user.role === 'student') {\n        return /*#__PURE__*/_jsxDEV(Navigate, {\n          to: \"/student/dashboard\",\n          replace: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 33,\n          columnNumber: 16\n        }, this);\n      } else if (user.role === 'librarian') {\n        return /*#__PURE__*/_jsxDEV(Navigate, {\n          to: \"/librarian/dashboard\",\n          replace: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 35,\n          columnNumber: 16\n        }, this);\n      }\n    }\n\n    // User is authenticated and has correct role (if required)\n    return children;\n  } catch (error) {\n    // Invalid user data, redirect to login\n    console.error('Error parsing user data:', error);\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 12\n    }, this);\n  }\n}\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["React","Navigate","jsxDEV","_jsxDEV","ProtectedRoute","children","role","token","localStorage","getItem","userStr","to","replace","fileName","_jsxFileName","lineNumber","columnNumber","user","JSON","parse","error","console","_c","$RefreshReg$"],"sources":["C:/Users/12622/Desktop/Library Management System db/frontend/src/components/ProtectedRoute.js"],"sourcesContent":["import React from 'react';\r\nimport { Navigate } from 'react-router-dom';\r\n\r\n/**\r\n * ProtectedRoute Component\r\n * \r\n * Protects routes that require authentication.\r\n * If user is not logged in, redirects to login page.\r\n * If user is logged in but wrong role, redirects to appropriate dashboard.\r\n * \r\n * Usage:\r\n * <ProtectedRoute role=\"student\">\r\n *   <StudentDashboard />\r\n * </ProtectedRoute>\r\n */\r\nfunction ProtectedRoute({ children, role = null }) {\r\n  // Check if user is logged in\r\n  const token = localStorage.getItem('access_token');\r\n  const userStr = localStorage.getItem('user');\r\n\r\n  // If no token, redirect to login\r\n  if (!token || !userStr) {\r\n    return <Navigate to=\"/login\" replace />;\r\n  }\r\n\r\n  try {\r\n    const user = JSON.parse(userStr);\r\n\r\n    // If role is specified, check if user has the correct role\r\n    if (role && user.role !== role) {\r\n      // Redirect to appropriate dashboard based on user's role\r\n      if (user.role === 'student') {\r\n        return <Navigate to=\"/student/dashboard\" replace />;\r\n      } else if (user.role === 'librarian') {\r\n        return <Navigate to=\"/librarian/dashboard\" replace />;\r\n      }\r\n    }\r\n\r\n    // User is authenticated and has correct role (if required)\r\n    return children;\r\n  } catch (error) {\r\n    // Invalid user data, redirect to login\r\n    console.error('Error parsing user data:', error);\r\n    return <Navigate to=\"/login\" replace />;\r\n  }\r\n}\r\n\r\nexport default ProtectedRoute;\r\n\r\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,QAAQ,QAAQ,kBAAkB;;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA,SAAAC,MAAA,IAAAC,OAAA;AAYA,SAASC,cAAcA,CAAC;EAAEC,QAAQ;EAAEC,IAAI,GAAG;AAAK,CAAC,EAAE;EACjD;EACA,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;EAClD,MAAMC,OAAO,GAAGF,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;;EAE5C;EACA,IAAI,CAACF,KAAK,IAAI,CAACG,OAAO,EAAE;IACtB,oBAAOP,OAAA,CAACF,QAAQ;MAACU,EAAE,EAAC,QAAQ;MAACC,OAAO;IAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EACzC;EAEA,IAAI;IACF,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACT,OAAO,CAAC;;IAEhC;IACA,IAAIJ,IAAI,IAAIW,IAAI,CAACX,IAAI,KAAKA,IAAI,EAAE;MAC9B;MACA,IAAIW,IAAI,CAACX,IAAI,KAAK,SAAS,EAAE;QAC3B,oBAAOH,OAAA,CAACF,QAAQ;UAACU,EAAE,EAAC,oBAAoB;UAACC,OAAO;QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MACrD,CAAC,MAAM,IAAIC,IAAI,CAACX,IAAI,KAAK,WAAW,EAAE;QACpC,oBAAOH,OAAA,CAACF,QAAQ;UAACU,EAAE,EAAC,sBAAsB;UAACC,OAAO;QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MACvD;IACF;;IAEA;IACA,OAAOX,QAAQ;EACjB,CAAC,CAAC,OAAOe,KAAK,EAAE;IACd;IACAC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;IAChD,oBAAOjB,OAAA,CAACF,QAAQ;MAACU,EAAE,EAAC,QAAQ;MAACC,OAAO;IAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EACzC;AACF;AAACM,EAAA,GA9BQlB,cAAc;AAgCvB,eAAeA,cAAc;AAAC,IAAAkB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}